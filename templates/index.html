<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ò–ò</title>
    <link rel="stylesheet" href="/static/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <div class="container">
        <h1>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ "—á–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç—å"</h1>
        <p>–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç. –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∏—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω –ø–æ—Ö–æ–∂ –Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ò–ò.</p>

        <form id="checkForm">
            <textarea id="textInput" name="text" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏..." rows="10"></textarea>
            <button type="submit">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        </form>

        <div id="result" class="result"></div>
    </div>

    <script>
        document.getElementById('checkForm').onsubmit = async (e) => {
            e.preventDefault();
            const text = document.getElementById('textInput').value.trim();
            if (!text) return alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç!');

            const res = await fetch('/check', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: `text=${encodeURIComponent(text)}`
            }).then(r => r.json());

            const resultEl = document.getElementById('result');
            let html = `<p><strong>–î–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞:</strong> ${res.text_length} —Å–∏–º–≤–æ–ª–æ–≤</p>`;

            if (res.ai_score_local !== null) {
                const color = res.ai_score_local > 50 ? '#d9534f' : '#5cb85c';
                const status = res.ai_score_local > 50 ? '–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –ò–ò' : '–ù–∞–ø–∏—Å–∞–Ω–æ —á–µ–ª–æ–≤–µ–∫–æ–º';
                html += `<p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> <span style="color:${color}; font-weight:bold;">${status}</span></p>`;
                html += `<p><strong>–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å:</strong> ${res.ai_score_local}%</p>`;
            } else {
                html += `<p class="error">–û—à–∏–±–∫–∞: ${res.error_local}</p>`;
            }

            resultEl.innerHTML = `<div class="card">${html}</div>`;
        };
    </script>
</body>
</html>